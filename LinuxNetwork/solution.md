## Part 1. Инструмент ipcalc


### 1.1

1. Адрес сети 192.167.38.54/13.
   ![img](pictures/ipcalc_1.png)

    Адрес указывается в поле Network - 192.160.0.0/13
2. Перевод маски 255.255.255.0 в префиксную и двоичную запись, /15 в обычную и двоичную, 
    11111111.11111111.11111111.11110000 в обычную и префиксную.
    - `255.255.255.0` = `/24` в префиксной и  `11111111.11111111.11111111.00000000` в двоичной записи.
    - `/15` = `11111111.11111110.00000000.00000000` в двоичной и `255.254.0.0` в десятичной записи.
    - `11111111.11111111.11111111.11110000` = `/28` в префиксной и `255.255.255.240` в десятичной записи.
3. Минимальный и максимальный хост в сети 12.167.38.4 при масках: /8, 11111111.11111111.00000000.00000000, 
    255.255.254.0 и /4.
    - С маской `/8`. Минимальный - `12.0.0.1`, максимальный - `12.255.255.254`
    - С маской `11111111.11111111.00000000.00000000 (/16)`. Минимальный - `12.167.0.1`, максимальный - `12.167.255.254`
    - С маской `255.255.254.0 (/23)`. Минимальный - `12.167.38.1`, максимальный - `12.167.39.254`
    - С маской `/4`. Минимальный - `0.0.0.1`, максимальный - `15.255.255.254`
    - 
### 1.2

Мы можем обратиться к приложению, запущенному на `localhost`, если его адрес находится в пространстве адресов
`127.0.0.0 — 127.255.255.255`

   - `194.34.23.100` не можем.
   - `127.0.0.2` можем.
   - `127.1.0.1` можем.
   - `128.0.0.1` не можем.


### 1.3


1. Приватные адреса начинаются со следующих чисел - 10, 127, 169, 172, 192. Все остальные IP относятся к публичным.
   - `10.0.0.45` - частный.
   - `134.43.0.2` - публичный.
   - `192.168.4.2` - частный.
   - `172.20.250.4` - частный.
   - `172.0.2.1` - публичный.
   - `192.172.0.1` - публичный.
   - `172.68.0.2` - публичный.
   - `172.16.255.255` - частный.
   - `192.169.168.1` - публичный.

2. Шлюз-это сетевое устройство, которое действует как точка входа из одной сети в другие сети. 
   Хост отправляет в сетевой шлюз по умолчанию (в частности, на IP-адрес сетевого шлюза) все пакеты,
   направленные на другие хосты вне локальной сети, 
   что означает, что хост без указанного адреса шлюза по умолчанию может обмениваться пакетами 
   только с компьютерами в той же локальной сети.

   В связи с распространением сети TCP/IP 
   понятие сетевого шлюза стало практически тождественным маршрутизатору. 
   Шлюз создается на границе сети для управления всеми данными, 
   которые обмениваются между внутренней сетью и внешними сетями.

   Из перечисленных IP адресов шлюза возможны у сети `10.10.0.0/18`:
   `10.10.0.2`, `10.10.10.10`,  `10.10.1.255`.

## Part 2. Статическая маршрутизация между двумя машинами

- Для первой машины ip a
   ![img](pictures/ip_a_1.png)

- Для второй машины ip a
  ![img](pictures/ip_a_2.png)

### Изменение адресов

- WS1
  ![img](pictures/ws1-yaml_1.png)
- WS2
  ![img](pictures/ws2-yaml_1.png)

- `netplan apply`
  - WS1
    ![img](pictures/netplan_apply_ws1.png)
  - WS2
    ![img](pictures/netplan_apply_ws2.png)

### 2.1

- `ip r add(ws1)`
   ![img](pictures/ip_r_add_ws1.png)

- `ip r add(ws2)`
  ![img](pictures/ip_r_add_ws2.png)

### `ping`
- WS1
  ![img](pictures/ping_ws1_1.png)
- WS2
  ![img](pictures/ping_ws2_1.png)

Для того чтоб связать я переключил настройки сети виртуальных машин на `internal network` (теперь нет выхода в интернет)
и вручную изменил кофигурационные файлы:
![img](pictures/config-for-routing-1.png) 

(для второй машины аналогично)

#### `Для удобства сделал второй сетевой интерфейс на каждой машине(для этого выключил) и добавил адаптер с конфигурацией NAT и добавл в конфиг файл`

## Part 3. Утилита iperf3

### 3.1
- `8 Mbps = 1 MB/s`
- `100 MB/s = 800000 Kbps`
- `1 Gbps = 1000 Mbps`


### 3.2
`iperf3` запускается на двух машинах. На ws2 в качестве сервера, на ws1 в качестве клиента.
- WS1 - клиент
  ![img](pictures/iperf3_ws1.png)
- WS2 - сервер
  ![img](pictures/iperf3_ws2.png)

## Part 4. Сетевой экран

### 4.1. Утилита iptables

- `/etc/firewall` для  ws1

   ![img](pictures/firewall_ws1.png)

   ![img](pictures/firewall_ws2_run.png)


- `/etc/firewall` для  ws2

  ![img](pictures/firewall_ws2.png)

  ![img](pictures/firewall_ws1_run.png)

`Разница между стратегиями заключается в том что если пакет удовлетворяет правилу, то мледующие правила не учитываются.
Следовательно если пропинговать перую машину, то ответа не поступит`
![img](pictures/firewall_ping.png)

### 4.2. Утилита nmap

- `nmap 192.168.100.10` выводит `Host is up`

   ![](pictures/nmap.png)

## Part 5. Статическая маршрутизация сети

### 5.1. Настройка адресов машин
* ***Содержимое файлов конфигурации для каждой машины***
![](pictures/config-routing_1.png)

  
* ***ip 4 a для каждой из машин и пинги***
![](pictures/ip_5_a.png)


### 5.2. Включение переадресации IP-адресов.


* ***`sysctl -w net.ipv4.ip_forward=1` для каждой машины***
  ![](pictures/sysctl_net_1.png)


* ***`net.ipv4.ip_forward=1` в конфигурации для каждой машины***
  ![](pictures/sysctl_net_2.png)


### 5.3. Установка маршрута по-умолчанию
* ***Содержимое файлов конфигурации для каждой машины***
  ![](pictures/config_gateway.png)

* ***Пинг***
  ![](pictures/ping_with_gateway.png)

### 5.4. Добавление статических маршрутов

* ***Содержимое файлов конфигурации для каждого роутера***
  ![](pictures/gateway_r1.png)


* ***`ip r`***
  ![](pictures/ip_r.png)


* ***`ip r list 10.10.0.0/[маска сети] и ip r list 0.0.0.0/0`***
![](pictures/ip_r_list.png)

потому что маска /18 описывает маршрут к сети точнее, в отличие от маски /0

### 5.5. Построение списка маршрутизаторов

* ***`traceroute`***
  ![](pictures/traceroute.png)


***Traceroute также отображает время, затраченное на прохождение пакета до каждого маршрутизатора на пути, а также адрес каждого промежуточного маршрутизатора. Это позволяет определить местонахождение сетевых узлов, проблемы в сетевой топологии и потенциальные узкие места в сетевом трафике.***

***В результате traceroute показывает маршрут, который сетевой пакет проходит, от отправителя к назначению, позволяя оценить качество и надежность соединения, а также определить возможные проблемы и места утечки трафика.***

### 5.6. Использование протокола ICMP при маршрутизации

* ***`ping -c 1 10.30.0.111`***
  ![](pictures/ping_not_exist.png)

## Part 6. Динамическая настройка IP с помощью DHCP

![img.png](pictures/dhcp_ws2_conf.png)

* До
![img.png](pictures/ip_a_ws21_dhcp_off.png)
* ***Установка конфигурации, `ip a` и `ping`***
![img.png](pictures/dhcp_ws21_ip_a.png)
![img.png](pictures/dhcp_ping_1.png)


* ***Измененный файл конфигурации сети на ws1 и `dhcpd.conf` для r1***
  ![img.png](pictures/config_dhcp_ws11.png)


* ***Перезапуск dhcp и `ip a` после ребута***
    ![img.png](pictures/ws11_updated_ip.png)


* ***До запроса обновления***
![img.png](pictures/ws21_ip_before_update.png)

* ***Запрос обновления ws21 и `ip a`***
![img.png](pictures/ws21_ip_after_update.png)



* ***Пинг c ws22 на ws21***
![](pictures/dhcp_ping.png)

  
* В этом задании пользовался функией автоматической выдачи адреса машинам в своей сети если они ждут обновления ip.
    Также функцией жесткой привязки по мак адресу и ручному запросу обновления адреса.


## Part 7. NAT

- `ports.conf`

![img.png](pictures/apache2_port.png)


- Пропинговал ws22 с r1

![img.png](pictures/nat_ping_ws22.png)


- Измененный `firewall.sh`

![img.png](pictures/change_firewall.png)















































































